import{H as y,N as A}from"./Navbar-C-QiNICq.js";import{m as D}from"./mixins-CNIKFpNw.js";import{_ as x,g as d,c as l,a as s,b as f,e as m,w as n,i as N,F as C,r as a,o as i,t as p,j as u}from"./app-C61jTV-o.js";const F={props:["id"],data(){return{pageTitle:"Edit Album",artists:[],albumData:{title:"",release_year:"",artist_id:null},isLoading:!0,snackbar:!1,formErrors:{}}},mounted(){this.fetchAlbum(this.id),this.fetchArtists().then(r=>{this.artists=r,this.isLoading=!1}).catch(r=>{console.error("Error fetching artist information:",r)})},mixins:[D],methods:{fetchAlbum(r){d.get("/api/album-edit/"+r).then(t=>{this.albumData=t.data}).catch(t=>{console.error("Error fetching album information:",t)})},async submitForm(){d.put("/api/album-update/"+this.id,this.albumData).then(r=>{this.snackbar=!0,this.formErrors={}}).catch(r=>{r.response.status===422?this.formErrors=r.response.data.errors:console.error("Error updating album:",r)})},deleteAlbum(r){confirm("Are you sure you want to delete this album?")&&d.delete(`/api/album-delete/${r}`).then(t=>{this.$router.push("/albums")}).catch(t=>{console.error("Error deleting album:",t)})}},components:{Header:y,Navbar:A}},w={class:"app-container__main"},H={class:"app-container__page"},L={key:0,class:"loading-spinner"},S={key:1},T={key:0,class:"error"},U={key:1,class:"error"},B={key:2,class:"error"};function M(r,t,j,R,e,_){const h=a("Navbar"),v=a("Header"),g=a("v-progress-circular"),k=a("v-select"),b=a("v-text-field"),c=a("v-btn"),E=a("v-form"),V=a("v-snackbar");return i(),l(C,null,[s(h),f("div",w,[s(v,{pagename:e.pageTitle},null,8,["pagename"]),f("div",H,[e.isLoading?(i(),l("div",L,[s(g,{color:"#3686FF",indeterminate:""})])):m("",!0),e.isLoading?m("",!0):(i(),l("div",S,[s(E,{onSubmit:N(_.submitForm,["prevent"])},{default:n(()=>[s(k,{modelValue:e.albumData.artist_id,"onUpdate:modelValue":t[0]||(t[0]=o=>e.albumData.artist_id=o),items:e.artists,"item-title":"name","item-value":"id",label:"Select an Artist"},null,8,["modelValue","items"]),e.formErrors.artist_id?(i(),l("span",T,p(e.formErrors.artist_id[0]),1)):m("",!0),s(b,{modelValue:e.albumData.title,"onUpdate:modelValue":t[1]||(t[1]=o=>e.albumData.title=o),label:"Album Title"},null,8,["modelValue"]),e.formErrors.title?(i(),l("span",U,p(e.formErrors.title[0]),1)):m("",!0),s(b,{modelValue:e.albumData.release_year,"onUpdate:modelValue":t[2]||(t[2]=o=>e.albumData.release_year=o),label:"Release Year"},null,8,["modelValue"]),e.formErrors.release_year?(i(),l("span",B,p(e.formErrors.release_year[0]),1)):m("",!0),s(c,{type:"submit"},{default:n(()=>[u("Edit Album")]),_:1})]),_:1},8,["onSubmit"]),s(c,{onClick:t[3]||(t[3]=o=>_.deleteAlbum(e.albumData.id)),class:"btn-delete"},{default:n(()=>[u("Delete album")]),_:1}),s(V,{modelValue:e.snackbar,"onUpdate:modelValue":t[5]||(t[5]=o=>e.snackbar=o)},{actions:n(()=>[s(c,{color:"pink",variant:"text",onClick:t[4]||(t[4]=o=>e.snackbar=!1)},{default:n(()=>[u(" Close ")]),_:1})]),default:n(()=>[u(" Album has been edited! :) ")]),_:1},8,["modelValue"])]))])])],64)}const G=x(F,[["render",M]]);export{G as default};
